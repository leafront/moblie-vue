{"remainingRequest":"/Users/shanliguo/Documents/wm-mobile/mobile-vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/shanliguo/Documents/wm-mobile/mobile-vue/src/App.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/shanliguo/Documents/wm-mobile/mobile-vue/src/App.vue","mtime":1554960393306},{"path":"/Users/shanliguo/Documents/wm-mobile/mobile-vue/node_modules/babel-loader/lib/index.js","mtime":1551093966843},{"path":"/Users/shanliguo/Documents/wm-mobile/mobile-vue/node_modules/cache-loader/dist/cjs.js","mtime":1551093967131},{"path":"/Users/shanliguo/Documents/wm-mobile/mobile-vue/node_modules/vue-loader/lib/index.js","mtime":1551093973497}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n\nimport {\n    Dialog,\n} from 'vant';\n\nexport default {\n    components: {\n        Dialog: Dialog,\n    },\n    created() {\n        this.userStatus();\n    },\n    mounted() {\n        window.onpopstate = () => {\n            if (!this.$store.state.allowBack) {\n                history.go(1);\n            }\n        }\n    },\n    methods: {\n        userStatus() {\n\n            if (this.$route) {\n                if (this.$route.name !== 'login') {\n                    let _this = this;\n                    setInterval(function () {\n                        _this.userFetch();\n                    }, 60000);\n                } else {\n                }\n            }\n        },\n        userFetch() {\n            this.$store.dispatch('userInfo', this).then(() => {\n                if (this.$store.state.userFetching === true) {\n                    const data = this.$store.state.userInfo;\n\n                    if (data !== null && data !== '' && data !== {} && data.data !== {}) {\n                        if (data.data && data.data.timeout) {\n\n                            Dialog.confirm({\n                                message: '登录信息已失效，请重新登录?',\n                                showCancelButton: false\n                            }).then(() => {\n                                // 超时\n                                if (localStorage.getItem('userName_current')) {\n                                    localStorage.setItem('userName_current', '');\n                                }\n                                if (localStorage.getItem('departName_current')) {\n                                    localStorage.setItem('departName_current', '');\n                                }\n\n                                this.$router.push({\n                                    name: 'login'\n                                });\n                            }).catch(() => {\n                            });\n\n                        } else {\n                        }\n                    } else {\n                        // 没有data\n                        if (localStorage.getItem('userName_current')) {\n                            localStorage.setItem('userName_current', '');\n                        }\n                        if (localStorage.getItem('departName_current')) {\n                            localStorage.setItem('departName_current', '');\n                        }\n\n                        this.$router.push({\n                            name: 'login'\n                        });\n                    }\n                } else {\n                    //接口不通\n                    if (localStorage.getItem('userName_current')) {\n                        localStorage.setItem('userName_current', '');\n                    }\n                    if (localStorage.getItem('departName_current')) {\n                        localStorage.setItem('departName_current', '');\n                    }\n\n                    this.$router.push({\n                        name: 'login'\n                    });\n                }\n            }).catch((err) => {\n                console.log(err);\n                // if (localStorage.getItem('userName_current')) {\n                //     localStorage.setItem('userName_current', '');\n                // }\n                // if (localStorage.getItem('departName_current')) {\n                //     localStorage.setItem('departName_current', '');\n                // }\n                //\n                // this.$router.push({\n                //     name: 'login'\n                // });\n            });\n        },\n    }\n}\n",{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;;AAOA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"App.vue","sourceRoot":"src","sourcesContent":["<template>\n    <div id=\"app\">\n        <router-view/>\n    </div>\n</template>\n\n<script>\n    import {\n        Dialog,\n    } from 'vant';\n\n    export default {\n        components: {\n            Dialog: Dialog,\n        },\n        created() {\n            this.userStatus();\n        },\n        mounted() {\n            window.onpopstate = () => {\n                if (!this.$store.state.allowBack) {\n                    history.go(1);\n                }\n            }\n        },\n        methods: {\n            userStatus() {\n\n                if (this.$route) {\n                    if (this.$route.name !== 'login') {\n                        let _this = this;\n                        setInterval(function () {\n                            _this.userFetch();\n                        }, 60000);\n                    } else {\n                    }\n                }\n            },\n            userFetch() {\n                this.$store.dispatch('userInfo', this).then(() => {\n                    if (this.$store.state.userFetching === true) {\n                        const data = this.$store.state.userInfo;\n\n                        if (data !== null && data !== '' && data !== {} && data.data !== {}) {\n                            if (data.data && data.data.timeout) {\n\n                                Dialog.confirm({\n                                    message: '登录信息已失效，请重新登录?',\n                                    showCancelButton: false\n                                }).then(() => {\n                                    // 超时\n                                    if (localStorage.getItem('userName_current')) {\n                                        localStorage.setItem('userName_current', '');\n                                    }\n                                    if (localStorage.getItem('departName_current')) {\n                                        localStorage.setItem('departName_current', '');\n                                    }\n\n                                    this.$router.push({\n                                        name: 'login'\n                                    });\n                                }).catch(() => {\n                                });\n\n                            } else {\n                            }\n                        } else {\n                            // 没有data\n                            if (localStorage.getItem('userName_current')) {\n                                localStorage.setItem('userName_current', '');\n                            }\n                            if (localStorage.getItem('departName_current')) {\n                                localStorage.setItem('departName_current', '');\n                            }\n\n                            this.$router.push({\n                                name: 'login'\n                            });\n                        }\n                    } else {\n                        //接口不通\n                        if (localStorage.getItem('userName_current')) {\n                            localStorage.setItem('userName_current', '');\n                        }\n                        if (localStorage.getItem('departName_current')) {\n                            localStorage.setItem('departName_current', '');\n                        }\n\n                        this.$router.push({\n                            name: 'login'\n                        });\n                    }\n                }).catch((err) => {\n                    console.log(err);\n                    // if (localStorage.getItem('userName_current')) {\n                    //     localStorage.setItem('userName_current', '');\n                    // }\n                    // if (localStorage.getItem('departName_current')) {\n                    //     localStorage.setItem('departName_current', '');\n                    // }\n                    //\n                    // this.$router.push({\n                    //     name: 'login'\n                    // });\n                });\n            },\n        }\n    }\n</script>\n\n<style>\n\n</style>\n"]}]}